{% extends "home.html" %}

{% block other_js %}
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.6/angular.min.js"></script>
{% endblock %}

{% block user_css %}
{% include "angular/pager.css" %}
{% endblock %}

{% block user_js %}
var ingressApp = angular.module('ingressApp', []);
ingressApp.controller('IngressController', function IngressController($scope, $http, PagerService) {
  $scope.all_cheaters = [];
  $scope.cheaters = [];
  $http.get('{% url 'reports:cheater_list' %}').
    success(function (data) {
      $scope.all_cheaters = data.cheaters;
      $scope.setPage(1);
    });

  $scope.pager = {};
  $scope.setPage = function (page) {
    if (page < 1 || page > $scope.pager.totalPages) {
      return;
    }
    $scope.pager = PagerService.GetPager($scope.all_cheaters.length, page);
    $scope.cheaters = $scope.all_cheaters.slice($scope.pager.startIndex, $scope.pager.endIndex + 1);
  }
});

{% include "angular/PagerService.js" %}
{% endblock %}


{% block content %}
<div class="row">
<div class="col-md-10 col-md-offset-1">
<div class="panel panel-default" style="text-align:center;">
  <div class="panel-heading">Cheaters...</div>
  <table class="table">
    <thead>
      <tr>
        <th style="width:5%;">#</th>
        <th style="width:30%;">name  <input style="font-weight:normal;line-height:normal;" placeholder="Search name" ng-model="$scope.search_cheater.name"></th>
        <th style="width:20%;">status
          <select ng-model="$scope.search_cheater.status">
            <option value="" selected>all</option>
            <option value="alive">alive</option>
            <option value="burned">burned</option>
          </select>
        </th>
        <th style="width:40%;">report status</th>
      </tr>
    </thead>
    <tr ng-repeat="cheater in cheaters | filter:$scope.search_cheater">
      <td>{% templatetag openvariable %}cheater.id{% templatetag closevariable %}</td>
      <td>{% templatetag openvariable %}cheater.name{% templatetag closevariable %}</td>
      <td>{% templatetag openvariable %}cheater.status{% templatetag closevariable %}</td>
      <td>reported <b>{% templatetag openvariable %}cheater.report_times{% templatetag closevariable %}</b> times in <b>{% templatetag openvariable %}cheater.report_count{% templatetag closevariable %}</b> reports.</td>
    </tr>
  </table>
{% include "angular/pager.html" %}
</div>
</div>
</div>
{% endblock %}
